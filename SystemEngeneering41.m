%决策属性表
y=[5,3.5,10,3;
   1,2,20,2;
   3,7,10,4];
%数据预处理
m1=5;
for i=1:1:3
    x(i,1)=y(i,1)/m1;
end
m21=2; %无法容忍下限
m22=12; %无法容忍上限
%最优区间[5,6]
x(2,2)=0;
x(1,2)=1-(5-3)/(5-m21);
x(3,2)=1-(7-5)/(m22-6);
m3=20;
for j=1:1:3
    x(j,3)=y(j,3)/m3;
end
m4=2;
for k=1:1:3
    x(k,4)=y(k,4)/m4-1;
end
%属性值规范化
x(1,1)=x(1,1)/sqrt(x(1,1)^2+x(2,1)^2+x(3,1)^2);
x(2,1)=x(2,1)/sqrt(x(1,1)^2+x(2,1)^2+x(3,1)^2);
x(3,1)=x(3,1)/sqrt(x(1,1)^2+x(2,1)^2+x(3,1)^2);
x(1,2)=x(1,2)/sqrt(x(1,2)^2+x(2,2)^2+x(3,2)^2);
x(2,2)=x(2,2)/sqrt(x(1,2)^2+x(2,2)^2+x(3,2)^2);
x(3,2)=x(3,2)/sqrt(x(1,2)^2+x(2,2)^2+x(3,2)^2);
x(1,3)=x(1,3)/sqrt(x(1,3)^2+x(2,3)^2+x(3,3)^2);
x(2,3)=x(2,3)/sqrt(x(1,3)^2+x(2,3)^2+x(3,3)^2);
x(3,3)=x(3,3)/sqrt(x(1,3)^2+x(2,3)^2+x(3,3)^2);
x(1,4)=x(1,4)/sqrt(x(1,4)^2+x(2,4)^2+x(3,4)^2);
x(2,4)=x(2,4)/sqrt(x(1,4)^2+x(2,4)^2+x(3,4)^2);
x(3,4)=x(3,4)/sqrt(x(1,4)^2+x(2,4)^2+x(3,4)^2);
%理想解和负理想解
xmax=[max(x(:,1)),max(x(:,2)),max(x(:,3)),max(x(:,4))];
xmin=[min(x(:,1)),min(x(:,2)),min(x(:,3)),min(x(:,4))];
%计算距离
d=zeros(3,2);
for t1=1:1:4
    d(1,1)=d(1,1)+(x(1,t1)-xmax(1,t1))^2;
    d(1,2)=d(1,2)+(x(1,t1)-xmin(1,t1))^2;
end
d(1,1)=sqrt(d(1,1));
d(1,2)=sqrt(d(1,2));
for t2=1:1:4
    d(2,1)=d(2,1)+(x(2,t2)-xmax(1,t2))^2;
    d(2,2)=d(2,2)+(x(2,t2)-xmin(1,t2))^2;
end
d(2,1)=sqrt(d(2,1));
d(2,2)=sqrt(d(2,2));
for t3=1:1:4
    d(3,1)=d(3,1)+(x(3,t3)-xmax(1,t3))^2;
    d(3,2)=d(3,2)+(x(3,t3)-xmin(1,t3))^2;
end
d(3,1)=sqrt(d(3,1));
d(3,2)=sqrt(d(3,2));
%计算排序指标值
for q=1:1:3
    C(q,1)=d(q,2)/(d(q,1)+d(q,2));
end